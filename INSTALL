I-dic INSTALL

  これはI-dicを各種FEPで使うための方法をまとめたものです。 (色々な人が
書いたものを集めたので文体がいろいろです。悪しからず)

  これらは一般的なUNIX環境あるいはMS-DOSの下で実行できるように作ってあ
ります。UNIX環境下では漢字コードの問題で一部ツールを GNU などの 8bit 
対応のものに入れ換える必要があります。DOS環境では、UNIX互換の make,
jperl を別途用意する必要があります。

【目次】

 0. 準備(共通)
 1. Wnn V4+egg
 2. ATOK6
 3. ATOK7
 4. VJE
 5. WXP
 6. 松茸
 7. EGBridge5.0 (for Macintosh)
 8. SJ3
 9. ことえり
10. Canna
11. WXII+
12. ATOK8
13. VJE-γ
14. EGBRIDGE 6.0
15. ATOK9
16. Wnn6
17. MS-IME95
18. MS-IME97
19. ATOK11
20. MS-IME2000
99. その他FEP

0. 準備

0.1 UNIX 版での準備

・Makefile 中の以下のマクロを、必要に応じて設定/変更する。

PERL,SORT,UNIQ: EUC を通す perl,sort,uniq。
ETOSJ: EUC を SJIS に変換するフィルタ。
FEPCVTOPT: 必要に応じてコメントをはずし、AV 人名の登録を抑制する。

0.2 DOS 版での準備

・jperl を用意する。
・AV 人名を登録したくない時は、make <fep-name> の代わりに
make <fep-name> -no_av と打つこと。(心の準備)

0.3 登録する品詞を選ぶ。

ファイル genre を必要に応じて編集する。


1.Wnn V4+egg

1.0  Makefile 中の Wnn4 utility の path を設定します。

1.1  make wnn4 します。
         これで、ユーザ辞書 i-dic.usr が完成します。

1.2  cp i-dic.usr /usr/local/lib/wnn/ja_JP/dic/usr/$USER/i-dic
     ($USER はユーザ名です。ディレクトリはWnnのインストールに
      より異なることがあります)

1.3  ~/.eggrc に
	 (setusrdic "i-dic" 10 t) 
     を入れます。

※システム辞書にする場合には Makefile のなかで、
        ATOD=/usr/local/bin/Wnn4/atod -S
とします。また辞書をコピーした後、
        wnntouch /usr/local/lib/wnn/ja_JP/dic/pubdic/i-dic.dic
をする必要があります。


2.ATOK6

  一行に「よみ,単語,品詞」を並べたファイルを作ります。品詞は 1: 名詞か 
3: 固有名詞ですが、ATOK の固有名詞の扱いは大馬鹿者なので、名詞が無難で
しょう。

例:

あーちゃ,A-Cha,1
あい,あい,1
あい,亜衣,1
あい,歩惟,1
あい,歩衣,1
あいえす,I.S.,1
あいえり,愛絵理,1
あいかわ,相川,1
あいかわえり,相川恵里,1

この形式のファイルを作るには make atok6 としてください。i-dic.dic とい
うファイルが出来ます。

読みの長さと種類に制限があるので注意する必要があるでしょう。(確か)空白
が単語に入れられないのが非常に辛い。

このファイルを用いて一太郎の辞書ユーティリティ UT を使い、メニューの
	5:一括登録
によって辞書に登録します。

単語を並べたファイル名と、旧・新辞書のドライブ名を入力するだけで、あと
はユーティリティが登録してくれます。

失敗した単語は TANGO.ERR というファイルに記録できますから、エラー番号
を見ながら適当に対処して作った辞書に追加すれば良いでしょう。

エラー番号とその原因:

1: 登録したい単語を記述したファイルの形式が違う
2: 読みの文字種が悪い
3: 読みの長さが悪い
4: 単語の文字種が悪い
5: 単語の長さが悪い


3.ATOK7

  ATOK6と一緒で、一太郎ver4に付属しているut.exeを使って登録します。そ
の前に、make atok7 としてI-dicの方を以下の形にしておきます。ATOK6とちょっ
と違いますので、ご注意を。

あいかわえり,相川恵里,02

  最後の02は固有名詞の意味です。I-dicの場合、全部固有名詞にしておいた
方がいいようです。

  そして、この形にI-dicのファイルを変換したら、このファイルと登録した
い辞書ファイルを指定すれば(もちろん、ut.exeの中の一括登録のところでで
す。)それでOKです。ただし、結構時間がかかりますのでご注意を。できれば、
全部RAM disk上でやった方が良いでしょう。フロッピー同士でやるのだけは避
けた方が良いと思います。

 なお、既に I-dic が登録してある辞書 (ATOK7L.DIC 等) に新しい version 
の I-dic を登録しようとすると、「登録できない単語が多すぎるので登録を
中止します」と言ったメッセージが出て途中で登録を中断されてしまう場合が
あります。この場合は、単語辞書をいくつかに分けてそれぞれ別に登録する必
要があります。今のところ、半分に分けて登録すればできるようです。


4.VJE

※文中に出てくる VJE-toolsというのは市販されているパソコンソフトです。
PC98用とAX用があるようです。

4.1 辞書原稿を作成する

I-dic のデータを元に、辞書原稿の作成を行います。辞書原稿は、単語の読み、
登録する単語、品詞情報を1行の中に、1つ以上の空白(半角スペースやタブ)で
区切って入れます。

VJE-βでは品詞を100種類以上持っているそうですが、VJE-Toolsでは代表的な
もの38種類に限定しています。

名詞の指定は、ユーザ品詞の名詞として登録するのが良いようです。I-dic か
ら awk などを使って以下のような辞書原稿を作ります。

あーちゃ	A-Cha		【人名】
あいかわえり	相川恵里		【人名】
あいざわかおる	相沢薫		【人名】
あいざわなほこ	相沢なほこ		【人名】
あいそはるひ	相曽晴日		【人名】
あいだけいこ	合田恵子		【人名】
あいだしょうこ	相田翔子		【人名】

【名詞】が一般名詞、【人名】が人名名詞、【地名】が地名名詞、
【固名】が固有名詞、【名サ】がサ変化名詞(〜するとなる名詞)です。

なお、姓と名前のファイルについては、システム品詞として、[人姓]、[人名]
として登録するつもりです。また、一括で原稿を作るので、辞書原稿毎に全部
同じ品詞にします。

4.2 辞書原稿の並べ替え

上記辞書原稿をVJEの読みコード順に従ってソートします。VJE-Toolsの中の 
vxsort というソフトを使います。

 vxsort -u -v seimei > seimei.srt

なんか、ソートプログラムの都合で、1つのファイルは2000行以下でないと駄
目だそうです。9801 でなかなか時間がかかります。

4.3 辞書ファイルを作成する

ソートされたファイルから、VJEの辞書ファイルを作ります。-sは作成する辞
書の空き領域だそうです。

 vx make -u -s20 seimei.srt seimei.dic

はい、これでできあがり。seimei.dic が、バイナリのVJE辞書ファイルです。

4.4 辞書の組み込み

9801のVJEに組み込むには辞書の併合処理のソフトを使い、

 vx merg seimei.dic vjeb.dic vjenew.dic

として、使える辞書を作成します。上の例では、vjenew.dic を vjeb.dic に
リネームして新しい辞書として使うのだそうです。この操作は、VJE-βに付属
の vmerge という辞書併合ソフトを使っても同様です。

MacVJEの場合は、(3) で作った辞書ファイル(バイナリ)を読み込んできて、ま
ずファイルの属性を変更します。

MacVJEに付属しているソフトVJE-Iconを起動して、辞書ファイルの属性を付加
したいファイルを指定するだけです。辞書ファイルの属性を付加した辞書ファ
イルを組み込むためには、アップルメニューからコントロールパネルを開いて、
VJEを指定し、そこで「辞書の和」という操作を起動します。

これで現在使用している辞書に、I-dic 辞書が組み込まれます。

辞書を改版するときには、「辞書の差」を使って、あらかじめ古い辞書の内容
を消した辞書を「現在の辞書」にしておくのがよいでしょう。マルチファイン
ダーの場合など、「現在の辞書」がどれであるかに注意が必要。


5.WXP

  WXP辞書へ一括登録する単語の一覧表のファイルの形式は、

> 見出し[TAB]登録語:品詞

ですから、例えば、

> あいかわえり[TAB]相川恵里:名詞

といった風にコンバートします。この形式のファイルを作るには make wxp と
してください。i-dic.dic というファイルが出来ます。

できた i-dic.dic を wxsai を用いて辞書に登録します。なお、見出しが長過
ぎるか、「っ」で始まる単語は登録できません。


6.松茸(V2)

6.1 はじめに。
  松茸の辞書併合には、辞書管理ユーティリティの JISHO.EXE を用います。

新松以外のソフトでは、松茸が附属していても、JISHO.EXE は附属していませ
んので注意して下さい。(98NOTE 用の「n松」には、JISHO.EXE が附属してい
ません。)

JISHO.EXE の操作はマニュアル(専門機能編)を参照して下さい。

6.2 登録用テキストファイルの形式
  JISHO.EXE で使うための登録用テキストファイルの形式は、何通りかが許され
ていますが、代表的な形式を以下に示します。

	にしむらともみ,"西村知美",人名*

	<読み>,"<漢字表記>",<品詞番号>

の形です。品詞番号は、番号ですが、テキストファイルの可読性を高めるため
に「人名*」「固有名詞*」といった書き方ができます。最後の「*」はユー
ザ辞書であることを表わします。

6.3 登録(併合)用テキストファイルの作成
  make mttk とすると、i-dic.dic というファイルが出来ます。

参考に i-dic の元データと変換された松茸登録用のテキストファイルの例を示
します。

   >i-dic:あーちゃ	A-Cha	15	
   >i-dic:あい	あい	2	

   <mttkadd:あーちゃ,"A-Cha",人名*
   <mttkadd:あい,"あい",人名*

6.4 テキストファイルの修正
 以後の作業は、MS-DOS 上で行なうことになりますが、その前に作業が必要に
なります。
松茸では辞書の構造上の制約から、読みは15文字以内でなければなりません。
この15文字とは、濁点、半濁点を含む文字は2文字として数えた場合の文字数
で、エディタなどで簡単に見つけることはできません。

1つの方法としては、awk などで半角20文字以上(全角で10文字以上)となる読
みの行を抽出して、MS-DOS テキストとし、新松に読み込んで
	ひらがな再変換→(Ctrl+_)→全角カタカナ→(Ctrl+o)→半角カタカナ
として半角カタカナの文字数を調べるという方法があります。

これらの言葉については、テキストファイルから削るか、短い読みに置き換える
か、2単語に分けて下さい。このままでは、これらは辞書登録できません。

元のまま併合させると、警告が出て作業の続行/中断を尋ねてきます。リターン
キーを入力して続行させても問題ありません。長い読みの語は登録されません。


6.5 辞書併合作業
 現在お使いの辞書をバックアップしてから、辞書併合をして下さい。
JISHO.EXE を立ち上げて、辞書併合を選択します。併合元はテキストファイルと
します。f-9 「形式」でテキストファイルを選択して下さい。品詞は全品詞のま
まで構いません。

  また、f-7 「印刷」でテキストファイル出力を選択しておいて下さい。
出力ファイル名をたとえば、i-dic300 としてファイルを出力させると、併合の
終わった辞書に i-dic300 を再度併合させることで、辞書を元の状態に戻すこと
ができます。i-dic のバージョンアップの際や、辞書併合でのエラーリカバリ
((5)参照)などで必要になります。

通常の辞書パスと違うディレクトリで作業をする時は、mpath でパス指定してか
ら作業を始める方が安心です。
また、作業に先立って、辞書サイズを大きくしておく方が良いと思われます。
(後でサイズを小さくできます。)

6.6 エラー対処など
  JISHO.EXE を使って作業した場合に以下のようなエラー警告がなされることが
あります。

文字数超過:
	リターンキーを押すと以後、登録できる項目だけを登録し、読みの文字
	数超過のために登録に失敗した項目についての報告をしなくなります。
	毎回報告させるようにすることは出来ないようです。
	((3) 参照。あらかじめ登録ファイルから削除しておいた方が良いでし
	ょう。)

辞書サイズ不足:
	特定の辞書のページ(インデクス情報により指されるデータのまとま
	り)内に登録できる限界以上に登録しようとした場合に起こります。
	註:手元の松茸辞書で起こりました。

	辞書サイズ不足の警告に対して、リターンキーを押して、以後の登録を
	続行させます。次いで、辞書整理の項目を実行させます。

	辞書整理によって、ページ内の使われ方が平均化されます。(インデク
	ス情報が新たに作成されます。)
	通常の場合、辞書サイズ600キロバイトで使用率82%程度になります。

	その後、出力テキストファイル(併合元ファイルではないことに注意し
	て下さい)を併合させ、今回の登録を全て削除します。

	こうすることによって、登録内容は併合前と同じで、ページインデクス
	は登録後に最適な状態の辞書になります。

	その後、改めて、元のテキストファイルを併合させて登録は終わりです。


6.7 その他
  辞書併合ファイルの可読性を高めるためにテキストファイルの品詞区分に冗長
な形式を用いましたが、ファイルを小さくしたい場合などは、

	固有名詞*	→58
	地名*		→59
	人名*		→60
	一般名詞*	→61

として下さい。併合作業は同じように行なえます。

参考:新松マニュアル「専門機能編」
   man の awk エントリ

以上。


7.EGBrigde5.0 (for Macintosh)

7.0 EGBridge5.0以上でないと一括登録の機能がないので注意して下さい。

7.1   make egb とすると、i-dic.dic というファイルが出来ます。
    登録は全部名詞扱いにしています。

7.2 Macintosh上にファイルをコピーします。

7.3 ツールEGBedを使って、ユーザー辞書の設定を行ないます。8000語として
    下さい。EGBedに関しての諸注意は製品マニュアルを御覧下さい。

7.4 EGBedで一括登録を行なって下さい。異常に時間がかかりますが、暴走
    しているわけではありません。(本当は暴走してたりして...)
    
	途中、いくつかの語が「登録できない」と出てくるが、これは
	EGBridge辞書の仕様なのであきらめよう。(ひろのぶ談)

7.5 出来たユーザー辞書は専門辞書へ変えたり、メイン辞書へマージする
    ことが可能です。

						以上


8. SJ3

make sj3 でインストールが完了します。


9. ことえり

9.1 一括登録形式テキストへの変換

make kotoeri で一括登録形式テキスト kotoeri というファイルができます。
作られる辞書に不満がある場合は、編集し直して下さい。

9.2 ダウンロード

ftp などにより、UNIX から Macintosh 側にダウンロードします。行末のコー
ドなどに注意して下さい。

9.3 登録

「ことえり辞書ツール」を起動します。「ことえり」状態で Option-Shift-T 
で起動されます。

「ファイル」メニューの「辞書の新規作成」か「辞書を開く」で辞書を開き、
「辞書」メニューの「テキストからの一括登録」でダウンロードしたテキスト
を開くと辞書が作成されます。

読みの長いもの(JIS X0201 カタカナ換算で 16 文字より長いもの)、読みが不
適切なもの("ゎ" で終っているものなど)は登録されません。

辞書の拡張、再編成は全て「ことえり辞書ツール」が行ないます。従って、登
録中特に行なうことはありません。

登録後、「ファイル」メニューの「テキスト形式で保存」を行なうことで辞書
の内容をテキストに変換することができますので、sort 後 diff することで
登録できなかったもののチェックに活用できます。

注: この登録方法は System J1-7.1f1c4 に附属のことえり 1.0f1 に基づくも
    のです。正式出荷版では変更される可能性があります。


10. Canna (Ver 2.2以上の場合ですがそれ以前でも大丈夫でしょう)

10.0 Makefile 中のCanna に関するpathを設定します。
10.1 make canna しますと、idic.t ができます。
     Canna 3.5 以上の場合は make canna35 します。
10.2 (固定長の辞書を作る場合のみ実行します。)

% make canna-install (Canna 3.5 以上の場合は make canna35-install)

または、

% mkbindic idic.t

します。

10.3

idic.t (10.2 を実行した場合は idic.d と idic.fq) を

/usr/local/lib/canna/dic/canna (サイトによって違いがあります。)

にコピーします。

10.4 

/usr/local/lib/canna/dic/canna/dics.dir (サイトによって違いがあります。)

に、

idic.d(idic.mwd)        -idic-
idic.fq(idic.mwd)       -idic-

を追加します。

10.5
cannaserver を再起動します。

10.6 ユーザーの側で設定をします。例えば、Emacs+Canna の場合には、

.canna に
(use-dictionary
 "iroha"

  ...

 "idic"

  ...

 :user  "user"
 )

というように use-dictionary に "idic" を追加します。


11. WXII+
make wx2p とすると、WXII+辞書テキスト形式の i-dic.dic が出来ます。

12. ATOK8
make atok8 とすると、ATOK8形式の単語ファイル i-dic.dic が出来ます。

13. VJE-γ
make vjeg とすると、VJE-γ形式の辞書原稿ファイル i-dic.dic が出来ます。

14. EGBRIDGE 6.0
make egb6 とすると、EGBRIDGE 6.0形式テキストファイル i-dic.dic が出来
ます。

15. ATOK9
make atok9 とすると、ATOK9形式の単語ファイル i-dic.dic が出来ます。

16. Wnn6
16.1 Makefile の ATOD を設定します。
16.2 make wnn6 とすると、wnn6形式のユーザ辞書 i-dic.usr が出来ます。

17. MS-IME95
make ime95 とすると、MS-IME95形式の単語ファイル i-dic.dic が出来ます。

18. MS-IME97
make ime97 とすると、MS-IME97形式の単語ファイル i-dic.dic が出来ます。

19. ATOK11
make atok11 とすると、ATOK11形式の単語ファイル i-dic.dic が出来ます。
なお, この操作で作られた i-dic.dic は語中に空白を含んでいます。
これで具合が悪い場合は同封の atok11-0.pl を atok11.pl にコピーしてお使
いください。 

20. MS-IME2000
make ime2000 とすると、MS-IME2000形式の単語ファイル i-dic.dic が出来ます。

99. その他のFEP

I-dic を、本ツールでサポートしていない FEP 用に変換するためには、以下
の二つの設定ファイルを用意する必要があります。(config ディレクトリにあ
る他のファイルを参考にしてください)

・品詞変換テーブル (config/<fep-name>.tbl)
・行出力用 perl スクリプト (config/<fep-name>.pl)

perl スクリプトでは、項目ごとに呼ばれるサブルーチン &print_line() を定
義してください。このサブルーチンには、引数として「読み」「表記」「品詞
名」が渡されます。
どちらのファイルとも漢字コードは、UNIX の場合は EUC、DOS の場合は SJIS 
をお使いください。

99.1 UNIX の場合

	% make print FEP=<fep-name>

とすると、標準出力に変換結果が出力されます。

99.2 DOS の場合

	> make <fep-name> [-no_av]

とすると、ファイル i-dic.dic に変換結果が出力されます。
